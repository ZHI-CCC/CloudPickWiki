---
title: 脚本创建界面
date: 2099-03-05 21:25:02
permalink: /js/脚本创建界面
categories:
  - 脚本
tags:
  - 脚本
---
# 脚本创建界面

除了使用 `.yml` 文件来静态定义UI布局，系统还支持在运行时通过构造JavaScript `Object` 来动态创建完整的UI界面或其一部分。这种方式提供了极大的灵活性，特别适用于那些布局结构需要根据程序逻辑动态生成的场景。

## 🤖 API 详解与核心概念

### 核心机制
其核心思想是**用一个JavaScript对象来完整描述一个UI控件及其所有子控件的层级结构**。这个对象的结构与YAML的声明方式高度对应。

*   **`type` 属性**: **必需项**。用于指定控件的类型，等同于YAML中的 `!Grid`, `!Button` 等。
*   **`children` 属性**: **容器专用**。一个**数组 (Array)**，用于存放该容器控件的所有子控件对象。
*   **其他属性**: 所有在“[公共属性](./公共属性)”文档中定义的属性（如 `name`, `width`, `height`, `horizontalAlign`, `events` 等）都可以作为对象的键值对直接写入。

### 示例一：构建一个完整的界面片段 (Segment)
以下代码定义了一个完整的 `Segment` 对象，其中包含一个 `Grid` 容器，而 `Grid` 内部又包含一个 `Button` 和一个 `Image`。

```javascript
// 定义一个变量来存储整个UI层级对象
var mySegmentObject = { 
  type: 'Segment',
  name: 'segment_1',
  children: [
    {
      type: 'Grid',
      width: 100,
      height: 50,
      horizontalAlign: 'Center',
      children: [
        {
          type: 'Button',
          text: '我是一个按钮',
          horizontalAlign: 'Right',
          verticalAlign: 'Left',
          marginLeft: 20,
          size: 50
        }, // 注意：数组中的对象需要用逗号分隔
        {
          type: 'Image',
          // 注意：background/source 等画刷属性同样支持
          background: 'texture://aa.png',
          horizontalAlign: 'Center'
        }
      ]
    }
  ]
};
```

#### 🔍 说明
1.  **根节点**：最外层的对象 `type` 为 `Segment`，这是整个UI的根容器。
2.  **第一层子节点**：`Segment` 的 `children` 数组中包含一个 `Grid` 对象。这个 `Grid` 被设置了固定的宽高和居中对齐。
3.  **第二层子节点**：`Grid` 的 `children` 数组中包含两个控件：
    *   一个 `Button`，被设置为右上对齐，并有左边距和固定尺寸。
    *   一个 `Image`，被设置为水平居中，并指定了背景图片。

### 示例二：单行定义一个简单控件
对于没有子控件的简单元素，其定义可以非常紧凑。

```javascript
// 这个对象描述了一个宽100、高20、垂直排列的StackPanel
var myStackPanelObject = {type: 'StackPanel', orientation: 'Vertical', width: 100, height: 20};
```

## 🔧 如何使用？
创建好这些UI对象后，通常会将它们传递给现有的段落（Segment）管理函数，来将其实例化并添加到屏幕上。

```javascript
// 假设 'currentSegment' 是当前已存在的界面片段
// 你可以使用 .add() 或 .replace() 等方法，将对象传入
currentSegment.add(mySegmentObject);

// 或者，如果你想替换掉当前界面
currentSegment.replace(myStackPanelObject);
```