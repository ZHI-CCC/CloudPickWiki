---
title: 详细处理玩家按键与鼠标输入
date: 2099-03-10 14:30:00
permalink: /js/详细处理玩家按键与鼠标输入
categories:
  - 脚本
tags:
  - 脚本
  - 输入
  - 交互
---

# 详细处理玩家按键与鼠标输入

该功能是创建交互式用户界面的核心。它允许您的UI界面直接响应用户的键盘按键和鼠标操作，为玩家提供直观、实时的交互体验，从而实现游戏菜单、控制面板、自定义HUD等复杂界面。

## 🤖 API 详解与脚本示例

### 核心机制
| 组件 | 类型 | 说明 |
| :--- | :--- | :--- |
| **`events.listener`** | UI控件配置 | 在控件的YAML配置中定义 `events.listener` 字段，用于声明输入事件处理函数。 |
| **`onKeyInput(event)`** | 键盘事件函数 | 当玩家在UI激活状态下按下或释放键盘按键时，系统会自动调用此函数。 |
| **`onMouseInput(event)`** | 鼠标事件函数 | 当玩家在UI控件上进行鼠标操作（点击、移动、拖拽等）时，系统会自动调用此函数。 |

### 事件对象方法
| 方法名 | 适用事件 | 返回值说明 |
| :--- | :--- | :--- |
| **`event.getAction()`** | 键盘事件 | 返回按键动作：`"DOWN"`（按下）、`"UP"`（释放）、`"REPEAT"`（长按重复） |
| **`event.getKeyCode()`** | 键盘事件 | 返回整数形式的按键代码（如87=W，65=A，32=空格） |
| **`event.getType()`** | 鼠标事件 | 返回事件类型：`"CLICK"`、`"MOVE"`、`"DRAG"`、`"ENTER"`、`"EXIT"`等 |
| **`event.getButton()`** | 鼠标事件 | 返回鼠标按钮：`"LEFT"`、`"RIGHT"`、`"MIDDLE"` |
| **`event.getX()` / `event.getY()`** | 鼠标事件 | 返回鼠标相对于控件左上角的坐标位置 |

### 示例代码
此示例展示了如何获取WASD按键

```yaml
- !Grid
  events:
    listener: |
      function onKeyInput(event) {
        var action = event.getAction();
        var keyCode = event.getKeyCode();
        
        // 只处理按下事件
        if (action === 'DOWN') {
          switch(keyCode) {
            case 87: // W键
              Chat.send("向前移动");
              break;
            case 65: // A键
              Chat.send("向左移动");
              break;
            case 83: // S键
              Chat.send("向后移动");
              break;
            case 68: // D键
              Chat.send("向右移动");
              break;
            case 32: // 空格键
              Chat.send("跳跃！");
              break;
          }
        }
      }
      
      function onMouseInput(event) {
        // 鼠标输入处理函数
      }
```